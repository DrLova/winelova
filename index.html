<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="common_styles.css">
    <style>
      .slider {
          position: absolute;
          left: 8%;
          width: 50%;
          height: 7px;
          background-color: #817f30; /* Track color */
      }

      .slider-track {
          position: absolute;
          top: 50%;
          left: 0;
          transform: translate(0, -50%);
          width: 100%;
          height: 2px; /* Track height */
          background-color: #3a0039; /* Highlight color */
      }

      .slider-handle {
          position: absolute;
          top: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #ff00d9a7; /* Handle color */
          border-radius: 50%;
      }
    </style>
    <title>search wines</title>
</head>
<body>
    <div id = "sweet" class="slider">
        <div id="slider-track0" class="slider-track"></div>
        <div id="slider-handle0" class="slider-handle"></div>
    </div>
    <div id = "sour" class="slider">
      <div id="slider-track1" class="slider-track"></div>
      <div id="slider-handle1" class="slider-handle"></div>
    </div>
    <div id = "tannic" class="slider">
      <div id="slider-track2" class="slider-track"></div>
      <div id="slider-handle2" class="slider-handle"></div>
    </div>
    <div id = "bodied" class="slider">
      <div id="slider-track3" class="slider-track"></div>
      <div id="slider-handle3" class="slider-handle"></div>
    </div>
    <div id = "alcoholic" class="slider">
      <div id="slider-track4" class="slider-track"></div>
      <div id="slider-handle4" class="slider-handle"></div>
    </div>
    <div id="fivevaluetextbox">hello</div>

    <a id ="sweet-mark" class="question-mark" href="sweet.html"> ? </a>
    <div id ="sour-mark" class="question-mark"> ? </div>
    <div id ="tannic-mark" class="question-mark"> ? </div>
    <div id ="bodied-mark" class="question-mark"> ? </div>
    <div id ="alcoholic-mark" class="question-mark"> ? </div>

    <div id ="sweet-label" class="tastelabel">甜度</div>
    <div id ="sour-label" class="tastelabel">酸度</div>
    <div id ="tannic-label" class="tastelabel">丹宁质</div>
    <div id ="bodied-label" class="tastelabel">酒体感</div>
    <div id ="alcoholic-label" class="tastelabel">酒精度</div>

    <script type ="text/JavaScript">
      function moveslider(sliderid, handleid) {
        const slider = document.getElementById(sliderid);
        const handle = document.getElementById(handleid);

        let isDragging = false;

        // Mouse events
        handle.addEventListener("mousedown", (e) => {
          isDragging = true;
        });

        document.addEventListener("mouseup", () => {
          isDragging = false;
        });

        document.addEventListener("mousemove", (e) => {
          if (isDragging) {
            updateSliderPosition(e.clientX);
          }
        });

        // Touch events
        handle.addEventListener("touchstart", (e) => {
          isDragging = true;
        });

        document.addEventListener("touchend", () => {
          isDragging = false;
        });

        document.addEventListener("touchmove", (e) => {
          if (isDragging) {
            const touch = e.touches[0];
            updateSliderPosition(touch.clientX);
          }
        });

        function updateSliderPosition(clientX) {
          const sliderRect = slider.getBoundingClientRect();
          const handleRect = handle.getBoundingClientRect();

          let newPosition = clientX - sliderRect.left - handleRect.width / 2;

          // Ensure the handle stays within the slider bounds
          if (newPosition < 0) {
            newPosition = 0;
          } else if (newPosition > sliderRect.width) {
            newPosition = sliderRect.width;
          }

          handle.style.left = newPosition + "px";
        }
      }

      function retrieveposition(handleid){
        // Assuming your object has an ID, let's say 'myObject'
        var myObject = document.getElementById(handleid);
        var myslider = document.querySelector('.slider')
        // Check if the object is found
        if (myObject) {
            // Get the position relative to the viewport
            var rect = myObject.getBoundingClientRect();
            var sliderrect = myslider.getBoundingClientRect();
            
            return (rect.left+(rect.width/2)-sliderrect.left)/sliderrect.width;
        } else {
            return "object not found";
        }
      };
      function updateposition(textboxid, valueid) {
        var myDiv = document.getElementById(textboxid);
        var position = retrieveposition(valueid);
        myDiv.textContent = position
    }  
      var tastes = new Array("sweet", "sour", "tannic", "bodied", "alcoholic");
      var anheight = 10;
      var toppad = 20;
      for (var ataste = 0; ataste < 5; ataste++) {
          var verticalpos = toppad + (anheight*ataste);
          var a_slider = document.getElementById(tastes[ataste]);
          a_slider.style.top = verticalpos+"%";
          moveslider("slider-track"+ ataste, "slider-handle"+ ataste);

          var questmark = document.getElementById(tastes[ataste]+"-mark");
          questmark.style.top = verticalpos+"%";
          var percentTop = questmark.offsetTop;
          questmark.style.top = ((percentTop/window.innerHeight)*100)-1.5+"%"
 


          var tastelabel = document.getElementById(tastes[ataste]+"-label");
          tastelabel.style.top = verticalpos+"%";
          tastelabel.style.top = ((percentTop/window.innerHeight)*100)-1.5+"%"

      }

      setInterval(() => {
        updateposition("fivevaluetextbox","slider-handle0","sweet")
      }, 1000);
    </script>
</body>
</html>
